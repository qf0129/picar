<!DOCTYPE html>
<html>
<head>
    <title>Index</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <script type="text/javascript" src="/static/jquery.js"></script>
</head>
<body>
<style type="text/css">
.touch_btn {
  width:50px;height:50px;background:#ddd;display: inline-block;margin: 5px;text-align: center;line-height: 50px;color: #ccc;
}
</style>
<div>
  <div id="1" class="touch_btn">⬆</div>
  <div id="2" class="touch_btn">⬇</div>
  <div id="3" class="touch_btn">⬅</div>
  <div id="4" class="touch_btn">➡</div>
</div>
<p class="tips"></p>
<input class="msg_input" name="">
<button class="send_msg_btn">Send</button>

<script type="text/javascript">
  Array.prototype.remove = function(val) {
    var index = this.indexOf(val);
    if (index > -1) {
      this.splice(index, 1);
    }
  };

  var ws = new WebSocket("ws://192.168.123.7:8000/websocket");

  function touch_change(touch_list){
      $('.tips').html(touch_list);
      ws.send(touch_list);
  }

  $('.touch_btn').bind('touchstart', touch_handler);
  $('.touch_btn').bind('touchend', touch_handler);
  $('.touch_btn').bind('touchmove', touch_handler);

  var touch_list = new Array();

  function touch_handler(){
       var event = event || window.event;  
       event.preventDefault();
       if (event.type=="touchstart"){
          touch_list.push($(this).attr('id'));
       }else if(event.type=="touchend"){
          touch_list.remove($(this).attr('id'));
       }
       touch_change(touch_list);
  }


  $('.send_msg_btn').click(function(){
      ws.send($('.msg_input').val());
  });

  // ws.onopen = function() {
  //     ws.send("Hello, world");
  // };
  ws.onmessage = function (evt) {
      console.log(evt.data);
  };

</script>
</body>
</html>